# Notification Configuration for FrontShiftAI ML Pipeline
# Defines email, Slack, and other notification settings

# Email Configuration (Gmail SMTP)
email:
  enabled: true
  smtp:
    server: "smtp.gmail.com"
    port_ssl: 465
    port_tls: 587
    use_ssl: true
    timeout: 15
    description: "Gmail SMTP server configuration"
  
  credentials:
    sender_env: "EMAIL_SENDER"
    password_env: "EMAIL_PASSWORD"
    receiver_env: "EMAIL_RECEIVER"
    description: "Email credentials from environment variables"
  
  templates:
    success: "ml_pipeline/ci_cd/templates/email_success.html"
    failure: "ml_pipeline/ci_cd/templates/email_failure.html"
    description: "HTML email templates for notifications"
  
  subject_prefix: "FrontShiftAI CI/CD"
  description: "Email notification settings"

# Slack Configuration (Optional)
slack:
  enabled: false
  webhook_url_env: "SLACK_WEBHOOK_URL"
  channel: "#ml-pipeline"
  username: "FrontShiftAI Bot"
  icon_emoji: ":robot_face:"
  template: "ml_pipeline/ci_cd/templates/slack_message.json"
  description: "Slack webhook notification settings (disabled by default)"

# Notification Rules
rules:
  # When to send notifications
  triggers:
    - event: "pipeline_start"
      send: false
      description: "Pipeline started (no notification)"
    
    - event: "pipeline_success"
      send: true
      channels: ["email"]
      description: "Pipeline completed successfully"
    
    - event: "pipeline_failure"
      send: true
      channels: ["email"]
      description: "Pipeline failed"
    
    - event: "quality_gate_fail"
      send: true
      channels: ["email"]
      description: "Quality gates failed"
    
    - event: "deployment_success"
      send: true
      channels: ["email"]
      description: "Model deployed successfully"
    
    - event: "deployment_failure"
      send: true
      channels: ["email"]
      description: "Model deployment failed"
    
    - event: "rollback"
      send: true
      channels: ["email", "slack"]
      description: "Model rollback executed"
  
  # Notification content
  include_in_notifications:
    - "pipeline_status"
    - "key_metrics"
    - "quality_gate_result"
    - "model_version"
    - "git_commit_hash"
    - "github_actions_run_url"
    - "wandb_run_url"
    - "execution_time"
    - "error_messages"  # Only for failures
    - "troubleshooting_suggestions"  # Only for failures
  
  # Rate limiting
  rate_limit:
    max_per_hour: 10
    max_per_day: 50
    description: "Prevent notification spam"

# GitHub Actions Integration
github_actions:
  run_url_template: "https://github.com/${GITHUB_REPOSITORY}/actions/runs/${GITHUB_RUN_ID}"
  commit_url_template: "https://github.com/${GITHUB_REPOSITORY}/commit/${GITHUB_SHA}"
  description: "GitHub Actions URL templates for notifications"

# W&B Integration
wandb:
  run_url_template: "https://wandb.ai/${WANDB_ENTITY}/${WANDB_PROJECT}/runs/${WANDB_RUN_ID}"
  include_run_links: true
  description: "W&B run URL templates for notifications"

# Notification Metadata
metadata:
  project_name: "FrontShiftAI"
  pipeline_name: "ML Evaluation Pipeline"
  contact_email: "${EMAIL_RECEIVER}"
  support_url: "https://github.com/MLOpsGroup9/FrontShiftAI/issues"
  description: "Metadata for notification templates"

